{
  "version": 3,
  "sources": ["../../controllers/auth.ts"],
  "sourcesContent": ["import passport from \"koa-passport\";\nimport { BasicStrategy } from \"passport-http\";\nimport { RouterContext } from \"koa-router\";\nimport * as users from '../models/users';\n\nconst verifyPassword = (user: any, password: string) => {\n  return user.password === password;\n}\n\npassport.use(new BasicStrategy(async (username, password, done) => {\n  // Replace this with your own authentication logic\n  let result: any[] = []\n  try {\n    result = await users.findByUsername(username);\n  } catch (error) {\n    console.log(`Error during authentication for user ${username}:\n${error}`)\n    done(null, false);\n  }\n\n  if (result.length) {\n    const user = result[0];\n    if (verifyPassword(user, password)) {\n      done(null, { user: user });\n    } else {\n      console.log(`Password incorrect for ${username}`);\n      done(null, false);\n    }\n  } else {\n    console.log(`No user found with username ${username}`);\n    done(null, false);\n  }\n}));\n\nexport const basicAuth = async (ctx: RouterContext, next: any) => {\n  await passport.authenticate(\"basic\", { session: false })(ctx, next);\n  if (ctx.status == 401) {\n    ctx.body = {\n      message: 'you are not authorized'\n    };\n  }\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAqB;AACrB,2BAA8B;AAE9B,YAAuB;AAEvB,MAAM,iBAAiB,CAAC,MAAW,aAAqB;AACtD,SAAO,KAAK,aAAa;AAC3B;AAEA,oBAAAA,QAAS,IAAI,IAAI,mCAAc,OAAO,UAAU,UAAU,SAAS;AAEjE,MAAI,SAAgB,CAAC;AACrB,MAAI;AACF,aAAS,MAAM,MAAM,eAAe,QAAQ;AAAA,EAC9C,SAAS,OAAP;AACA,YAAQ,IAAI,wCAAwC;AAAA,EACtD,OAAO;AACL,SAAK,MAAM,KAAK;AAAA,EAClB;AAEA,MAAI,OAAO,QAAQ;AACjB,UAAM,OAAO,OAAO;AACpB,QAAI,eAAe,MAAM,QAAQ,GAAG;AAClC,WAAK,MAAM,EAAE,KAAW,CAAC;AAAA,IAC3B,OAAO;AACL,cAAQ,IAAI,0BAA0B,UAAU;AAChD,WAAK,MAAM,KAAK;AAAA,IAClB;AAAA,EACF,OAAO;AACL,YAAQ,IAAI,+BAA+B,UAAU;AACrD,SAAK,MAAM,KAAK;AAAA,EAClB;AACF,CAAC,CAAC;AAEK,MAAM,YAAY,OAAO,KAAoB,SAAc;AAChE,QAAM,oBAAAA,QAAS,aAAa,SAAS,EAAE,SAAS,MAAM,CAAC,EAAE,KAAK,IAAI;AAClE,MAAI,IAAI,UAAU,KAAK;AACrB,QAAI,OAAO;AAAA,MACT,SAAS;AAAA,IACX;AAAA,EACF;AACF;",
  "names": ["passport"]
}
